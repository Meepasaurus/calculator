"use strict";var Calculator=function(e,a,c,t){var s=a,r=c,i=t,l="",n="",k=["+","-","*","/"],o=["n","s","g"],u=0,b=!1,h=!1;return{printOutput:function(e,a){e?(s.html(""===l?"&nbsp;":"&gt;"+l),a&&""!==n&&i.prepend($('<p class="flow-text">').html(s.html()))):(r.html(""===n?"&nbsp;":n),a&&""!==n&&i.prepend($('<p class="flow-text">').html(r.html())))},inputNum:function(e){h?(this.clearEntry(),h=!1,b=!1):b&&(this.clearEntry(),b=!1),n+=e,this.printOutput(!1,!1)},calculate:function(){if(""!==n){for(;k.indexOf(n.charAt(n.length-1))!==-1;)n=n.slice(0,-1);for(n=n.replace(/\d+(?:\.\d+)?/g,function(e){return Number(e)});u>0;)n+=")",u--;n=n.replace(/&radic;/g,"sqrt"),n=n.replace(/[\d\.]\(|\)[\d\.]|\)\(/g,function(e){return e=e.split(""),e.splice(1,0,"*"),e.join("")}),n=n.replace(/[\d\.][sctl]|\)[sctl]/g,function(e){return e=e.split(""),e.splice(1,0,"*"),e.join("")})}if(l=n.replace(/Math\./g,""),l=l.replace(/sqrt/g,"&radic;"),""!==n)try{var e=Number(Number(math.eval(n).toFixed(14)).toPrecision(16)).toString();isNaN(e)?(n="That's undefined.",h=!0):n=e}catch(e){n="Invalid input.",h=!0}this.printOutput(!1,!0),this.printOutput(!0,!0),b=!0},operate:function(e){h&&(n="",h=!1);var a=n.charAt(n.length-1);switch(e){case"+":switch(a){case"":Materialize.toast("Cannot start input with +",2e3,"toast");break;case"+":break;case"-":n=n.slice(0,-1)+"+";break;default:n+="+"}break;case"-":switch(a){case"-":break;case"+":n=n.slice(0,-1)+"-";break;default:n+="-"}break;case"*":switch(a){case"":Materialize.toast("Cannot start input with &Cross;",2e3,"toast");break;case"+":n=n.slice(0,-1)+"*";break;case"-":n=n.slice(0,-1)+"*";break;case"*":break;case"/":n=n.slice(0,-1)+"*";break;case"(":Materialize.toast("Cannot use &Cross; after (",2e3,"toast");break;default:n+="*"}break;case"/":switch(a){case"":Materialize.toast("Cannot start input with &divide;",2e3,"toast");break;case"+":n=n.slice(0,-1)+"/";break;case"-":n=n.slice(0,-1)+"/";break;case"/":break;case"*":n=n.slice(0,-1)+"/";break;case"(":Materialize.toast("Cannot use &divide; after (",2e3,"toast");break;default:n+="/"}break;case".":this.decimal();break;case"(":n+="(",u++;break;case")":u>0?(n+=")",u--):Materialize.toast("Mismatched parentheses.",2e3,"toast");break;case"^":switch(a){case"^":Materialize.toast("Cannot use two ^ in a row.",2e3,"toast");break;default:n+="^"}break;case"sin":n+="sin(",u++;break;case"cos":n+="cos(",u++;break;case"tan":n+="tan(",u++;break;case"log":n+="log(",u++;break;case"sqrt":n+="&radic;(",u++}b=!1,this.printOutput(!0,!1),this.printOutput(!1,!1)},decimal:function(){b&&(n="");var e=n.match(/\.\d*$/);""===n&&(e=null),e?Materialize.toast("Please use one decimal point per number.",2e3,"toast"):n+="."},clearHistory:function(){i.html("")},allClear:function(){this.clearEntry(),l="",this.printOutput(!0,!1)},clearEntry:function(){h=!1,b=!1,n="",this.printOutput(!1,!1)},backspace:function(){if(""!==n){if(h)h=!1,n="";else{var e=n.charAt(n.length-1);switch(e){case".":n=n.slice(0,-1);break;case"(":u--,n=n.slice(0,-1);break;case")":u++,n=n.slice(0,-1);break;case"y":n="";break;default:n=n.slice(0,-1)}e=n.charAt(n.length-1),o.indexOf(e)!==-1&&(n=n.slice(0,-3),e=n.charAt(n.length-1)),console.log(e),";"===e&&(n=n.slice(0,-7),e=n.charAt(n.length-1)),b="y"===e}this.printOutput(!1,!1)}}}};$(document).ready(function(){var e=new Calculator(14,$("#output-top"),$("#output-bottom"),$("#history-text"));$(".num").on("click",function(){e.inputNum($(this).text())}),$(".mod").on("click",function(){var a=$(this).data("input");switch(a){case"ac":e.allClear();break;case"ce":e.clearEntry();break;case"backspace":e.backspace();break;case"history":e.clearHistory();break;case"+":case"-":case"*":case"/":case".":case"(":case")":case"^":case"sqrt":case"sin":case"cos":case"tan":case"log":e.operate(a);break;case"=":e.calculate()}}),$(document).on("keydown",function(a){switch(a.which){case 8:return e.backspace(),!1;case 46:e.allClear()}}),$(document).on("keypress",function(e){switch(e.which){case 8:e.preventDefault();break;case 40:$("#lp").click();break;case 41:$("#rp").click();break;case 120:case 42:$("#multiply").click();break;case 43:$("#plus").click();break;case 45:$("#minus").click();break;case 46:$("#decimal").click();break;case 47:$("#divide").click(),e.preventDefault();break;case 48:$("#zero").click();break;case 49:$("#one").click();break;case 50:$("#two").click();break;case 51:$("#three").click();break;case 52:$("#four").click();break;case 53:$("#five").click();break;case 54:$("#six").click();break;case 55:$("#seven").click();break;case 56:$("#eight").click();break;case 57:$("#nine").click();break;case 13:case 61:$("#equals").click();break;case 92:$("#ce").click();break;case 94:$("#caret").click();break;case 99:$("#cos").click();break;case 104:case 113:$("#history").click();break;case 108:$("#log").click();break;case 114:$("#sqrt").click();break;case 115:$("#sin").click();break;case 116:$("#tan").click()}})});